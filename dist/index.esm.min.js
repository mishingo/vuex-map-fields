import traverse from"traverse";function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],n=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw i}}return t}}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function arrayToObject(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,r){var t=r.split(".").slice(-1)[0];if(e[t])throw new Error("The key `".concat(t,"` is already in use."));return e[t]=r,e},{})}function computeTree(e,r,t,n,a){return r=JSON.parse(JSON.stringify(r)),traverse(r).forEach(function(r){var i="".concat(a,".").concat(this.path.join("."));this.isLeaf?Object.defineProperty(this.parent.node,this.key,buildLeafPropertyObject(e,i,n,t)):this.isRoot||Object.defineProperty(this.parent.node,this.key,buildBranchPropertyObject(e,r,i,n,t))})}function buildLeafPropertyObject(e,r,t,n){return{get:function(){return e.getters[t](r)},set:function(t){e.commit(n,{path:r,value:t})}}}function buildBranchPropertyObject(e,r,t,n,a){return{get:function(){return r},set:function(i){e.commit(a,{path:t,value:i}),r=computeTree(e,i,a,n,t)}}}function normalizeNamespace(e){return function(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];var a=_slicedToArray("string"==typeof t[0]?[].concat(t):[""].concat(t),4),i=a[0],o=a[1],u=a[2],c=a[3];return i.length&&"/"!==i.charAt(i.length-1)&&(i+="/"),u="".concat(i).concat(u||"getField"),c="".concat(i).concat(c||"updateField"),e(i,o,u,c)}}function getField(e){return function(r){return r.split(/[.[\]]+/).reduce(function(e,r){return e[r]},e)}}function updateField(e,r){var t=r.path,n=r.value;t.split(/[.[\]]+/).reduce(function(e,r,t,a){return a.length===t+1&&(e[r]=n),e[r]},e)}var mapFields=normalizeNamespace(function(e,r,t,n){var a=Array.isArray(r)?arrayToObject(r):r;return Object.keys(a).reduce(function(e,r){var i=a[r],o={get:function(){return this.$store.getters[t](i)},set:function(e){this.$store.commit(n,{path:i,value:e})}};return e[r]=o,e},{})}),mapMultiRowFields=normalizeNamespace(function(e,r,t,n){var a=Array.isArray(r)?arrayToObject(r):r;return Object.keys(a).reduce(function(e,r){var i,o=a[r];return e[r]={get:function(){var e=this.$store;if(i)return i;var r=e.getters[t](o);return i=computeTree(e,r,n,t,o)},set:function(e){var r=this.$store;if(r.commit(n,{path:o,value:e}),"object"!=typeof e)r.commit(n,{path:o,value:e});else{var a=r.getters[t](o);i=computeTree(r,a,n,t,o)}}},e},{})}),createHelpers=function(e){var r,t=e.getterType,n=e.mutationType;return _defineProperty(r={},t,getField),_defineProperty(r,n,updateField),_defineProperty(r,"mapFields",normalizeNamespace(function(e,r){return mapFields(e,r,t,n)})),_defineProperty(r,"mapMultiRowFields",normalizeNamespace(function(e,r){return mapMultiRowFields(e,r,t,n)})),r};export{createHelpers,getField,mapFields,mapMultiRowFields,updateField};